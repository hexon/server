create table t1(a int);
insert into t1 select seq from seq_1_to_10000 order by rand(3);
CREATE TABLE t2(
id INT NOT NULL,
names VARCHAR(64),
address VARCHAR(132),
PRIMARY KEY (id)
);
CREATE FUNCTION f1(median float, a INT, b INT) RETURNS INT
BEGIN
set @x= rand(a), @y= rand(b);
if (@x = 0) then
return round(median);
end if;
set @z = ((sqrt(-2*log(@x))*cos(2*pi()*@y))*5)+median;
set @z = round(@z);
if (@z = 0) then
return 1;
end if;
return @z;
END|
CREATE function f2(a INT, b INT) RETURNS varchar(256)
BEGIN
DECLARE str VARCHAR(256) DEFAULT '';
DECLARE x INT DEFAULT 0;
WHILE (a > 0 AND a < 256) DO
set x =round(rand(b)*25);
set str= CONCAT(str, CHAR(65 + x));
set a= a-1;
set b= b+1;
END WHILE;
RETURN str;
END|
insert into t2
select a, f2(f1(12, a, a+1), a) , f2(f1(32, a+10, a+11) ,a)
FROM t1;
set sort_buffer_size=262144*10;
flush status;
select id, MD5(group_concat(names, address)) from t2 group by id DIV 100 ORDER BY id;
id	MD5(group_concat(names, address))
86	22df0faf47b10c9d11a59f15fcc0cd7c
131	f48daafa73033243452ce98c994c7df5
289	5bbfc9975a78a1545d48eeeab3ccb7a6
313	b878d78eda439802b00f3aa864041ab7
426	64861f73873d298783ae3df4dbdbd795
558	3b566dc62f1069e0c69e2b2415a12520
614	5283581a0fd278ea261d8242f47425ca
710	4b3cf74b3cfbb1519747284fa69a2de8
891	ddb6e98f22864dde6e654395538fd889
952	322289763c7af9325438906ad321ad20
1078	71f2e86eb8bcec3f16838d555cbeb574
1199	8f45aa07d7cd7d0d99afa5c1774e725f
1231	a8f30986f28ed02c7ca45f90b5eceacf
1352	fb00fc3f6460a1265664136654f31b6f
1467	dc45193dd071654b33fe6359bb135a49
1549	4e2eba1acb1a969820291db66c6fb948
1601	d87ac43253d4327909018bf946ef2a30
1735	00a2d5ae7c29826d2027ee8a00d09b4a
1852	32cebe01f98d0c7811c6909879ea23fa
1949	946b889370ca94bbfbfe850e99c7e3ed
2041	03744dcf4d8a3b7a8c62b48a06de6639
2185	2582b6389839b10f790fcc07ab4d1148
2292	30478b8d7659778ea89ceb2107bf4a33
2320	9375304f4e726435004a635480c5a12a
2447	84fa533a21ce3f8b4683074ffa63b768
2593	8d3574f5166d37b14090015b1daf8cbd
2608	53c76f7556c3a5040e2858745833f407
2768	e21d511348c7e14e4598448ed2cb4280
2892	48c511bad2a8424d9438df2414cc0bca
2909	8e151cc9b625d8daa168dba6bfedc74b
3075	026f625b888b57bdc98c3a8d7bdb4954
3129	c35a28ef321e0935eeb1a145707de878
3284	ea97effcc6354cb24f9891c3e626d67b
3346	63a890b6bf692fed74811489e0848d68
3424	93c16829746aecab3af4da953f940e20
3522	74fd3258d875bdce2b0dd20a89df995d
3686	ea77598e91d78bfd859c2c7407d60e72
3717	f10d76ba301b37206d97f51ebae09b9f
3811	c93bd05a8158b0b50d3304d18143cf8c
3936	9e43baa966c9120576d8592d80a8709c
4087	90932468543c535f76af332df8fb5abd
4123	79350cdea361380143baeaba9627778b
4288	652397ec1fcd74bd8c54c2120c9071e3
4376	3985adbebd5aceec65c57a43fc93ac21
4491	d408a4c0a3bb3704afbee20a76a716b6
4579	68d7a0042e3fd1b6879ba6b1d7e42a06
4608	0566b4e7d819794acd2392238f71f6cc
4791	cd4710c6d45eb895348649d433da965f
4872	2082ba0ed2cab2f9c5a3a34fd4836b88
4999	d71f209396d9f5e12a0728574adfb765
5008	f1b51307e1c3da6994734af13a6824a4
5192	b275e71b0bd863b4e9eeb3498e9dd04f
5200	bf87bffce33509abc41a7961f80224f2
5312	7011dc792d1ad3052ebe4c651fd52dfd
5412	cb09c1752ac569a141a245667392413e
5513	0adece135dcfd041671400cb3683d045
5667	03a5c975b006f3f461c7fcc8153a33bd
5777	21bec4ece57b98ebf73a91aa65a041cd
5874	a2e0fb4144b9073bd59898eb30c70708
5953	4daf26c680676ab88b58b2becd7cda45
6075	e4b30322ed02a58f2ad81847f639e6c5
6161	ef6362925c908f34bc1935712840ec43
6283	706f7041b4f00617dba75355ea25d4a2
6332	5304246e15679717525055a6a3bf1bb8
6443	67313b8efc9efd4bbcba24163be7c7c0
6524	786414a291b10ce6442c480f7e44098e
6606	665762da72d27c3f9647984b98ed5218
6715	17d81cbe572286f9a658518193ca8ad4
6889	cb61f7167f1f06949b2ecfee9dc54bae
6976	0b0217c64f7db4381ba47cb48c3768b6
7032	dd1e85d8d5d136103718f2e118e8a6dc
7143	8807018b5fbe63d0257389ac79699c46
7274	7bac850b3a5e48877e69956dc3d36c4f
7301	7fb02906dfabfffbd65bfe8d49620830
7439	766b7e6db70cb4551d7ba82de5f69a4e
7580	9dc86a1883e6ee4aec2357c7cded8426
7686	9e97e59af3149081fe76f986ea379d84
7733	3446012b1c374db54e9894cb2222a2f9
7845	81b70ced9803601451eedadf89dc460d
7968	3b2f4e25a7c0f331ef047ed5f50208ce
8088	e4957e4cff1037dcdfd77b3249d66f8b
8170	5a1e9c62e3962df3a5a5b8799e09a55f
8296	d0de1f3131373b97535bf3f989661bfe
8335	30fb98c0250ae1318398dd52a8569b08
8496	2c85c3e5aa0ebd69a21fa04fdee22643
8519	85a99e62811378c50229aed993534534
8637	77b699c2f4bd300c3acbc63be954776f
8773	e08a60b169d1d740839dcd25e1b9a442
8866	a7c1c2aad01bac7db1675c447125b1dd
8968	10a79eecbcbaa68279842176500bb45c
9008	1e088809b8af99e93390cc979cd3ede5
9177	b2d90b7d963ec54c3009b35f35662471
9231	2523726607ee6537846f2e6a9e4b7916
9391	e410c04744b5394f87befe5f6be95301
9460	1cd996e473eae349745fe422477c52b9
9558	42457b654b6aa1daa08fa8eacef5d5ae
9698	515f56914b27123efe9260deab420b29
9786	c1d928943b8b69d6662a1c5eaa933ad1
9869	7804d794e6bbe1f0354c1b1d695f1e8f
9975	fdb739500767cbbf226e2bc1626b44c6
10000	bd499f19974a13570fb8941d725efa69
show status like '%sort%';
Variable_name	Value
Sort_merge_passes	0
Sort_priority_queue_sorts	0
Sort_range	0
Sort_rows	10101
Sort_scan	2
set sort_buffer_size=default;
drop function f1;
drop function f2;
drop table t1,t2;
